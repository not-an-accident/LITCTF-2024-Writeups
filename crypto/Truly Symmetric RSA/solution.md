# Truly Symmetric RSA
Solves: 100, Points: 153

Author: w0152
## Problem Description
I just realized that it doesn't make sense for people without the key to be able to encrypt messages, so I fixed that.
## Reading Material
[SageMath](https://doc.sagemath.org/html/en/tutorial/)

[SageMath Installation](https://doc.sagemath.org/html/en/installation/index.html)

[RSHack](https://github.com/RsaCtfTool/RsaCtfTool)

[FactorDB](https://factordb.com/)
## Solution
Upon opening the chal.py file, we see:
```python
#!/usr/bin/env python3
from Crypto.Util.number import long_to_bytes as ltb, bytes_to_long as btl, getPrime

p = getPrime(1536)
q = getPrime(1024)

n = p*q

e = p

with open("flag.txt", "rb") as f:
	PT = f.read()

CT = pow(btl(PT), e, n)
print(f"{len(PT) = }")
print(f"{CT = }")
print(f"{n = }")
```
The output.txt file:
```python
len(PT) = 62
CT = 155493050716775929746785618157278421579720146882532893558466000717535926046092909584621507923553076649095497514130410050189555400358836998046081044415327506184740691954567311107014762610207180244423796639730694535767800541494145360577247063247119137256320461545818441676395182342388510060086729252654537845527572702464327741896730162340787947095811174459024431128743731633252208758986678350296534304083983866503070491947276444303695911718996791195956784045648557648959632902090924578632023471001254664039074367122198667591056089131284405036814647516681592384332538556252346304161289579455924108267311841638064619876494634608529368113300787897715026001565834469335741541960401988282636487460784948272367823992564019029521793367540589624327395326260393508859657691047658164
n = 237028545680596368677333357016590396778603231329606312133319254098208733503417614163018471600330539852278535558781335757092454348478277895444998391420951836414083931929543660193620339231857954511774305801482082186060819705746991373929339870834618962559270938577414515824433025347138433034154976346514196324140384652533471142168980983566738172498838845701175448130178229109792689495258819665948424614638218965001369917045965392087331282821560168428430483072251150471592683310976699404275393436993044069660277993965385069016086918288886820961158988512818677400870731542293709336997391721506341477144186272759517750420810063402971894683733280622802221309851227693291273838240078935620506525062275632158136289150493496782922917552121218970809807935684534511493363951811373931
```
There are two ways to solve this question, and I will go over each one in detail.
### Method 1: FactorDB
This challenge ended up having more solves than the first part, which I'm prety sure was due to most people using this solution. Someone left the factors of n on a commonly used website called FactorDB. Plugging the n value into the website, we get:

![Factors](/img/bruh.png)

Now that we have the factors, we can easily decrypt. (Note that this solution doesn't even use the fact that len(PT)=62). Here's a script:
```python
from Crypto.Util.number import long_to_bytes
#known values
n = 237028545680596368677333357016590396778603231329606312133319254098208733503417614163018471600330539852278535558781335757092454348478277895444998391420951836414083931929543660193620339231857954511774305801482082186060819705746991373929339870834618962559270938577414515824433025347138433034154976346514196324140384652533471142168980983566738172498838845701175448130178229109792689495258819665948424614638218965001369917045965392087331282821560168428430483072251150471592683310976699404275393436993044069660277993965385069016086918288886820961158988512818677400870731542293709336997391721506341477144186272759517750420810063402971894683733280622802221309851227693291273838240078935620506525062275632158136289150493496782922917552121218970809807935684534511493363951811373931
c = 155493050716775929746785618157278421579720146882532893558466000717535926046092909584621507923553076649095497514130410050189555400358836998046081044415327506184740691954567311107014762610207180244423796639730694535767800541494145360577247063247119137256320461545818441676395182342388510060086729252654537845527572702464327741896730162340787947095811174459024431128743731633252208758986678350296534304083983866503070491947276444303695911718996791195956784045648557648959632902090924578632023471001254664039074367122198667591056089131284405036814647516681592384332538556252346304161289579455924108267311841638064619876494634608529368113300787897715026001565834469335741541960401988282636487460784948272367823992564019029521793367540589624327395326260393508859657691047658164
#value taken from factordb
p = 166557948517947271602258708955353083026274048402782170034916605639170445810916175731832950474019678010329384082970296325017242397316290035922839952890208544473504626005637889150472278147142362245139458190781187137604895353015229778871887992562978949246618018439273471303640390434063058576022156952959455779553
q=n//p
phi=(p-1)*(q-1)
d = pow(q, -1, phi)
#the e value is either p or q, try both and see whichever one gives you the flag, in this case it's q
print(long_to_bytes(pow(c, d, n)))
```
>[!WARNING]
>Do not rely on this method. This method only works because someone posted the factors, and in most CTFs, someone won't be posting the factors.
